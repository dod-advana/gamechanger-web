FROM node:14
RUN npm config set @dod-advana:registry https://npm.pkg.github.com
COPY .npmrc .npmrc
RUN npm install -g nodemon
RUN npm install -g sequelize-cli
RUN npm install -g jest
COPY . /usr/src/app
WORKDIR /usr/src/app/frontend
RUN npm install
RUN npm run build
RUN mv build ../backend/
WORKDIR /usr/src/app/backend
RUN npm install
RUN rm -f .npmrc
CMD ./startProd.sh